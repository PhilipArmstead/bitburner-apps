export async function main(ns) {

	// Immediate app-specific code
	const previewTheme = ({ detail }) => {
		try {
			ns.ui.setTheme(JSON.parse(detail))
		} catch (e) {
			console.log(e)
		}
	}

	const { apply: themeToApply, 'apply-id': themeIdToApply } = ns.flags([['apply', ""], ['apply-id', ""]])
	if (themeToApply) {
		return previewTheme({ detail: themeToApply })
	}


	// Boilerplate
	const doc = globalThis['document']
	const id = 'theme-browser-app'
	globalThis[`${id}-version`] = '0.0.44'

	let vueLoaded
	const vueLoad = new Promise((resolve) => (vueLoaded = resolve))

	if (!doc.getElementById('vue-js-lib')) {
		const script = doc.createElement('script')
		script.id = 'vue-js-lib'
		script.src = 'https://cdn.jsdelivr.net/npm/vue@3.2.26/dist/vue.runtime.global.prod.js'
		script.onload = vueLoaded
		doc.head.insertAdjacentElement('beforeend', script)
	} else {
		vueLoaded()
	}


	// Extract current theme as CSS varibles for apps
	let stylesheet = doc.getElementById('theme-variables')
	if (!stylesheet) {
		stylesheet = doc.createElement('style')
		stylesheet.id = 'theme-variables'
		doc.head.insertAdjacentElement('beforeend', stylesheet)
	}

	stylesheet.innerHTML = `:root {
		--font-family: ${getComputedStyle(doc.querySelector('p'))['font-family']};
${Object.entries(ns.ui.getTheme()).map(([key, value]) => `--${key}: ${value};`).join('\n')}
	}`


	// Add app's CSS and mount point
	doc.getElementById(id)?.remove()
	doc.body.insertAdjacentHTML('beforeend', `<section id="${id}"></section>`)

	doc.getElementById(`${id}-css`)?.remove()
	doc.head.insertAdjacentHTML('beforeend', `<style id="${id}-css">${bundledCss}</style>`)

	const updateApp = async ({ detail: { element, path }}) => {
		await ns.wget(path, ns.getScriptName())
		element.dispatchEvent(new CustomEvent('app:updated'))
	}

	doc.body.addEventListener('app:update:theme-browser-app', updateApp)

	// Unset some stuff on app death
	ns.atExit(() => {
		doc.getElementById(id)?.remove()
		doc.getElementById(`${id}-css`)?.remove()
		doc.body.removeEventListener('app:update:theme-browser-app', updateApp)


		try {
			doc.body.removeEventListener('theme:preview', previewTheme)
			doc.body.removeEventListener('theme:cancel-preview', resetTheme)

		} catch (e) {
			console.log(e)
		}

	})

	await vueLoad


	// App-specific setup
	const currentTheme = ns.ui.getTheme()
	const resetTheme = () => ns.ui.setTheme(currentTheme)

	globalThis[`${id}-theme-id`] = themeIdToApply

	doc.body.addEventListener('theme:preview', previewTheme)
	doc.body.addEventListener('theme:cancel-preview', resetTheme)


	// Let's go
	mount()

	while (doc.getElementById(id)) {
		await ns.asleep(2000)
	}
} 


















// App CSS
const bundledCss = ".app-container[data-v-54e5fede]{bottom:0;left:0;pointer-events:none;position:fixed;top:0;width:100%;z-index:1510}.app-container.app--can-resize .app[data-v-54e5fede]{resize:both}.app-container.app--is-minimised .app[data-v-54e5fede]{height:auto!important;min-height:0;min-width:0;resize:none}.app-container.app--is-minimised .app .app__content[data-v-54e5fede]{display:none}.app-container *[data-v-54e5fede]{box-sizing:border-box}.app-container .app[data-v-54e5fede]{align-items:flex-start;border:1px solid #4E4E4E6B;display:inline-flex;flex-direction:column;left:0;height:500px;overflow:hidden;pointer-events:auto;position:absolute;resize:none;top:0;transform:translate(-50%,-52%);width:300px}.app-container .app__toolbar[data-v-54e5fede]{background:#111;color:#fff;display:flex;padding:4px 3px 4px 8px;user-select:none;width:100%}.app-container .app__title[data-v-54e5fede]{align-self:center;flex:0 1 100%;font-family:var(--font-family, monospace);font-size:13px;font-weight:700;line-height:1;margin:0 20px 0 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.app-container .app__cta-group[data-v-54e5fede]{align-items:center;display:flex;flex:0 1 100%;justify-content:flex-end;margin-left:auto}.app-container .app__cta-group>*[data-v-54e5fede]{background-position:50% 50%;background-size:14px auto;flex:0 1 auto}.app-container .app__cta-group .icon[data-v-54e5fede]{width:16px}.app-container .app__cta-group .icon--restore[data-v-54e5fede]{color:#d6cec8}.app-container .app__cta-group .icon--update[data-v-54e5fede]{color:#6bd700}.app-container .app__cta-group .btn[data-v-54e5fede]{background:none;border:none;color:#a9a9a9;cursor:pointer;display:flex}.app-container .app__icon[data-v-54e5fede]{align-self:center;max-height:16px;margin-right:6px;object-fit:contain;width:16px}.app-container .app__menu[data-v-54e5fede]{width:100%;background:#d4d0c8;color:#333;padding-left:5px;padding-bottom:2px}.app-container .app__menu span[data-v-54e5fede]{border:1px inset transparent;cursor:pointer;font-size:15px;margin-right:12px;padding:0 1px}.app-container .app__menu span[data-v-54e5fede]:hover{border:1px inset #BDBDBD}.app-container .app__content[data-v-54e5fede]{flex:0 1 100%;overflow:auto;scrollbar-color:var(--primary, #272727) var(--primarydark, #B7B7B7);scrollbar-width:thin;width:100%}.app-container .app__content[data-v-54e5fede]::-webkit-scrollbar{display:block;width:10px}.app-container .app__content[data-v-54e5fede]::-webkit-scrollbar-track{background-color:var(--primarydark, #B7B7B7)}.app-container .app__content[data-v-54e5fede]::-webkit-scrollbar-thumb{background-color:var(--primary, #272727)}.app-container .app .btn[data-v-54e5fede]{background:none;box-shadow:none}.modal[data-v-0be2425c]{background:#FFF;border:1px solid #0003;border-radius:6px;display:flex;flex-wrap:wrap;left:50%;padding:24px;position:absolute;top:50%;transform:translate(-50%,-50%);width:40vw}.modal__title[data-v-0be2425c]{color:#212529;font-size:20px;font-weight:500;line-height:1.5;margin:0}.modal__message[data-v-0be2425c]{line-height:1.4}.modal__ctas[data-v-0be2425c],.modal__message[data-v-0be2425c]{flex:1 0 100%;margin:16px 0 0}.modal__ctas[data-v-0be2425c]{display:flex;justify-content:flex-end}.modal .cta[data-v-0be2425c]{border:1px solid transparent;border-radius:4px;cursor:pointer;display:inline-block;font-weight:400;font-size:16px;line-height:1.5;margin-left:12px;padding:6px 12px;text-align:center;transition:.15s ease-in-out;transition-property:color,background-color,border-color,box-shadow;vertical-align:middle}.modal .cta[data-v-0be2425c]:hover{text-decoration:none}.modal .cta--cancel[data-v-0be2425c]{background-color:#6c757d;border-color:#6c757d;color:#fff}.modal .cta--cancel[data-v-0be2425c]:hover{background-color:#5a6268;border-color:#545b62;color:#fff}.modal .cta--cancel[data-v-0be2425c]:active{background-color:#545b62;border-color:#4e555b;color:#fff}.modal .cta--confirm[data-v-0be2425c]{background-color:#28a745;border-color:#28a745;color:#fff}.modal .cta--confirm[data-v-0be2425c]:hover{background-color:#218838;border-color:#1e7e34;color:#fff}.modal .cta--confirm[data-v-0be2425c]:active{background-color:#1e7e34;border-color:#1c7430;color:#fff}.app-wrapper[data-v-ac30e006],.update-modal[data-v-ac30e006],button[data-v-ac30e006]{font-family:Fira Sans,Trebuchet MS,Ubuntu,Helvetica,Arial,sans-serif}.update-modal[data-v-ac30e006]{background:rgba(51,51,51,.7);height:100%;left:0;position:fixed;top:0;width:100%;z-index:1512}.theme-list[data-v-2147ed84]{display:flex;flex-wrap:wrap;list-style:none;margin:0;padding:0}.theme-list .theme[data-v-2147ed84]{box-sizing:border-box;display:flex;flex:0 0 33%;flex-direction:column;margin:0;padding:16px}.theme-list .theme__name[data-v-2147ed84],.theme-list .theme__author[data-v-2147ed84]{text-align:center}.theme-list .theme__name[data-v-2147ed84]{color:#80f20d;font-size:18px;font-weight:500;margin:14px 0 0}.theme-list .theme__author[data-v-2147ed84]{color:#ccced0;font-size:14px;margin:8px 0 0}.theme-list .theme__preview[data-v-2147ed84]{aspect-ratio:1.5;cursor:pointer;display:block;height:auto;pointer-events:auto;transition:transform .2s cubic-bezier(.4,0,.2,1);width:100%}.theme-list .theme__preview[data-v-2147ed84]:hover{transform:scale(1.1)}[data-v-5d9c49d6] .app-container .app{left:50%;height:90vh;max-width:1166px;top:50%;transform:translate(-50%,-52%);width:90vw}.theme-browser[data-v-5d9c49d6]{align-items:baseline;background:#171A22;box-sizing:border-box;color:#fff;display:flex;flex-wrap:wrap;height:inherit;justify-content:space-between;min-height:100%;padding:24px 32px}.title[data-v-5d9c49d6],.pagination-details[data-v-5d9c49d6]{flex:0 1 auto;margin:0}.title[data-v-5d9c49d6]{margin-right:20px}.pagination-details[data-v-5d9c49d6]{color:#cecece;margin-left:20px}.themes[data-v-5d9c49d6]{margin-top:16px}.loader[data-v-5d9c49d6]{align-self:center;background:no-repeat 55% 50%/100px auto url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cg fill='%23900'%3E%3Ccircle cx='60' cy='50' r='4'%3E%3Canimate attributeName='cx' repeatCount='indefinite' dur='1s' values='95;35' keyTimes='0;1' begin='-0.67s'/%3E%3Canimate attributeName='fill-opacity' repeatCount='indefinite' dur='1s' values='0;1;1' keyTimes='0;0.2;1' begin='-0.67s'/%3E%3C/circle%3E%3Ccircle cx='60' cy='50' r='4'%3E%3Canimate attributeName='cx' repeatCount='indefinite' dur='1s' values='95;35' keyTimes='0;1' begin='-0.33s'/%3E%3Canimate attributeName='fill-opacity' repeatCount='indefinite' dur='1s' values='0;1;1' keyTimes='0;0.2;1' begin='-0.33s'/%3E%3C/circle%3E%3Ccircle cx='60' cy='50' r='4'%3E%3Canimate attributeName='cx' repeatCount='indefinite' dur='1s' values='95;35' keyTimes='0;1' begin='0s'/%3E%3Canimate attributeName='fill-opacity' repeatCount='indefinite' dur='1s' values='0;1;1' keyTimes='0;0.2;1' begin='0s'/%3E%3C/circle%3E%3C/g%3E%3Cg fill='%2380f20d' transform='translate(-15 0)'%3E%3Cpath d='M50 50L20 50A30 30 0 0 0 80 50Z'%3E%3CanimateTransform attributeName='transform' type='rotate' repeatCount='indefinite' dur='1s' values='0 50 50;45 50 50;0 50 50' keyTimes='0;0.5;1'/%3E%3C/path%3E%3Cpath d='M50 50L20 50A30 30 0 0 1 80 50Z'%3E%3CanimateTransform attributeName='transform' type='rotate' repeatCount='indefinite' dur='1s' values='0 50 50;-45 50 50;0 50 50' keyTimes='0;0.5;1'/%3E%3C/path%3E%3C/g%3E%3C/svg%3E\");flex:1 0 100%;height:200px;margin:auto 0 40%;width:200px}.preview__ctas[data-v-5d9c49d6]{bottom:0;display:flex;height:150px;justify-content:space-between;position:fixed;right:30px;width:150px}.preview__ctas:not(.preview__ctas--visible) .preview__cta[data-v-5d9c49d6]{pointer-events:none}.preview__ctas:not(.preview__ctas--visible) .preview__cta--cancel[data-v-5d9c49d6]{transform:translate(190px,160px)}.preview__ctas:not(.preview__ctas--visible) .preview__cta--confirm[data-v-5d9c49d6]{transform:translate(110px,160px)}.preview__ctas .preview__cta[data-v-5d9c49d6]{align-items:center;background:no-repeat 50% 50%/30px auto;border:none;border-radius:50%;cursor:pointer;display:flex;flex:0 1 44%;height:66px;justify-content:center;padding:0;position:relative;transition:transform .25s cubic-bezier(.4,0,.2,1)}.preview__ctas .preview__cta--cancel[data-v-5d9c49d6]{background-color:#e33030d4;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 47.095 47.095'%3E%3Cpath fill='%23FFF' d='m45.363 36.234-13.158-13.16 12.21-12.21a5.906 5.906 0 0 0 0-8.358 5.908 5.908 0 0 0-8.356 0l-12.212 12.21-12.809-12.81a5.91 5.91 0 1 0-8.358 8.358l12.81 12.81L1.732 36.831a5.91 5.91 0 1 0 8.356 8.359l13.759-13.758 13.16 13.16a5.908 5.908 0 0 0 8.356 0 5.907 5.907 0 0 0 0-8.358z'/%3E%3C/svg%3E\");transform:translateY(40px)}.preview__ctas .preview__cta--confirm[data-v-5d9c49d6]{background-color:#72d000d4;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 122.877 101.052'%3E%3Cpath fill='white' d='M4.43 63.63A14.383 14.383 0 0 1 .003 53.52a14.393 14.393 0 0 1 4.015-10.281 14.372 14.372 0 0 1 10.106-4.425 14.373 14.373 0 0 1 10.283 4.012l24.787 23.851L98.543 3.989l1.768 1.349-1.77-1.355a2.27 2.27 0 0 1 .479-.466A14.383 14.383 0 0 1 109.243.022V.018l.176.016c3.623.24 7.162 1.85 9.775 4.766a14.383 14.383 0 0 1 3.662 10.412h.004l-.016.176a14.362 14.362 0 0 1-4.609 9.632L59.011 97.11l.004.004a2.157 2.157 0 0 1-.372.368 14.392 14.392 0 0 1-9.757 3.569 14.381 14.381 0 0 1-9.741-4.016L4.43 63.63z'/%3E%3C/svg%3E\")}.sr-only[data-v-5d9c49d6]{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}@keyframes slide-up-left-5d9c49d6{0%{transform:translate(150px,150px)}to{transform:translate(0)}}\n"

// Don't worry about it.
function mount() {
	const winnerdow = globalThis
	const rockument = globalThis['document'];
	var Oe=Object.defineProperty,Le=Object.defineProperties;var Te=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var D=(e,r,c)=>r in e?Oe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[r]=c,z=(e,r)=>{for(var c in r||(r={}))We.call(r,c)&&D(e,c,r[c]);if(F)for(var c of F(r))je.call(r,c)&&D(e,c,r[c]);return e},O=(e,r)=>Le(e,Te(r));(function(e){"use strict";function r(n){rockument.querySelector(`#${n} .app-container`).dispatchEvent(new CustomEvent("app:close"))}function c(n,o){rockument.body.dispatchEvent(new CustomEvent(n,{detail:o}))}const L=async(n,o)=>{const a=await fetch(o).then(t=>t.text());return T(a,n)?a:null},T=(n,o)=>{const a=n.split(".").map(Number),t=o.split(".").map(Number);for(let s=0;s<a.length;++s){if(a[s]>t[s])return!0;if(t[s]>a[s])return!1}return!1};var He="",v=(n,o)=>{const a=n.__vccOpts||n;for(const[t,s]of o)a[t]=s;return a};const W={name:"AppContainer",props:{title:{type:String,required:!0},availableUpdate:{type:[String,Promise],default:null},versionFilePath:{type:String,default:null},id:{type:String,default:null},options:{type:Object,default:()=>({})}},setup({options:n}){const o=e.ref(null),a=e.ref(!1),t=e.ref(),s=e.ref(),p=e.ref(),i=e.ref(),l=e.ref(),d=e.ref(),b=e.ref();let k={},f={};const w=e.ref(!1),m=Object.assign({canDrag:!0,canMinimise:!0,canResize:!0},n),g=()=>{const _=o.value.offsetWidth,y=o.value.offsetHeight;i.value=winnerdow.innerWidth,l.value=winnerdow.innerHeight,d.value=i.value/2-_/2,b.value=l.value/2-y/2};e.onMounted(()=>{m.canResize?new ResizeObserver(([{borderBoxSize:[{inlineSize:_,blockSize:y}]}])=>{a.value&&!w.value&&(t.value=_,s.value=y),a.value=!0}).observe(o.value):a.value=!0,m.canDrag&&g()});const N=({x:_,y,button:u})=>{if(!m.canDrag)return;const h=rockument.body;u||(k={x:_,y},t.value=o.value.offsetWidth,s.value=o.value.offsetHeight,f={x:d.value,y:b.value},i.value=winnerdow.innerWidth,l.value=winnerdow.innerHeight,h.addEventListener("mousemove",P),h.addEventListener("mouseup",B),h.addEventListener("mouseleave",B))},B=()=>{const _=rockument.body;_.removeEventListener("mousemove",P),_.removeEventListener("mouseup",B),_.removeEventListener("mouseleave",B)};e.onUnmounted(B);const P=({x:_,y})=>{let u=f.x+(_-k.x),h=f.y+(y-k.y);const U=u<0,De=u+t.value>i.value;(U||De)&&(U?u=0:u=i.value-t.value,f.x=u,k.x=Math.max(Math.min(_,i.value-5),5));const I=h<0,ze=h+s.value>l.value;(I||ze)&&(I?h=0:h=l.value-s.value,f.y=h,k.y=Math.max(Math.min(y,l.value),5)),d.value=u,b.value=h};return{isMinimised:w,left:d,process:o,processHeight:s,processWidth:t,top:b,windowOptions:m,beginGrabbing:N,setPosition:g,toggleMinimise:()=>{w.value||(p.value=s.value),w.value=!w.value,w.value||(s.value=p.value)}}}},S=n=>(e.pushScopeId("data-v-54e5fede"),n=n(),e.popScopeId(),n),j={class:"app__title"},H={class:"app__cta-group"},R=["title"],G=[S(()=>e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 417 417",class:"icon icon--update"},[e.createElementVNode("path",{fill:"#FFF",d:"M120 90h180v235H120z"}),e.createElementVNode("path",{fill:"currentColor",d:"M208.5 417a208.5 208.5 0 1 0 0-417 208.5 208.5 0 0 0 0 417zm-81.3-197.5 68.3-118.3a15 15 0 0 1 26 0l68.2 118.3a15 15 0 0 1-13 22.5h-33.2v66.2a15 15 0 0 1-15 15h-40a15 15 0 0 1-15-15V242h-33.3a15 15 0 0 1-13-22.5z"})],-1))],q={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",class:"icon icon--minimise"},J=[S(()=>e.createElementVNode("path",{d:"m3 13h12v2h-12z",fill:"currentColor"},null,-1))],K={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",class:"icon icon--restore"},Q=[e.createStaticVNode('<rect x="5" y="1.5" width="11" height="3" stroke="none" fill="#000" data-v-54e5fede></rect><g fill="currentColor" data-v-54e5fede><rect x="5.8" y="4.3" width="9.4" height="6.5" stroke="#000" stroke-width="1.6" data-v-54e5fede></rect><rect x="1.8" y="9" width="9.4" height="6.5" stroke="#000" stroke-width="1.6" data-v-54e5fede></rect></g><rect x="1" y="6.2" width="11" height="3" stroke="none" fill="#000" data-v-54e5fede></rect>',3)],X=[S(()=>e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",class:"icon icon--close"},[e.createElementVNode("g",{stroke:"currentColor","stroke-width":"1.5"},[e.createElementVNode("line",{x1:"3",y1:"3",x2:"15",y2:"15"}),e.createElementVNode("line",{x2:"3",y1:"3",x1:"15",y2:"15"})])],-1))],Y={class:"app__content"};function Z(n,o,a,t,s,p){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["app-container",{"app--is-minimised":t.isMinimised,"app--can-resize":t.windowOptions.canResize}])},[e.createElementVNode("div",{ref:"process",class:"app",style:e.normalizeStyle({transform:`translate(${t.left}px, ${t.top}px)`,width:`${t.processWidth}px`,height:`${t.processHeight}px`})},[e.createElementVNode("div",{class:"app__toolbar",onMousedown:o[6]||(o[6]=(...i)=>t.beginGrabbing&&t.beginGrabbing(...i))},[e.createElementVNode("h1",j,e.toDisplayString(a.title),1),e.createElementVNode("div",H,[a.availableUpdate?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn--small app__cta-update-available",title:`Version ${a.availableUpdate} is available`,onClick:o[0]||(o[0]=i=>n.$emit("app:click:update")),onMousedown:o[1]||(o[1]=e.withModifiers(()=>{},["stop"]))},G,40,R)):e.createCommentVNode("",!0),t.windowOptions.canMinimise?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn--small app__cta-minimise",onClick:o[2]||(o[2]=(...i)=>t.toggleMinimise&&t.toggleMinimise(...i)),onMousedown:o[3]||(o[3]=e.withModifiers(()=>{},["stop"]))},[e.withDirectives((e.openBlock(),e.createElementBlock("svg",q,J,512)),[[e.vShow,!t.isMinimised]]),e.withDirectives((e.openBlock(),e.createElementBlock("svg",K,Q,512)),[[e.vShow,t.isMinimised]])],32)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn--small app__cta-close",title:"Close",onClick:o[4]||(o[4]=i=>n.$emit("app:close")),onMousedown:o[5]||(o[5]=e.withModifiers(()=>{},["stop"]))},X,32)])],32),e.createElementVNode("div",Y,[e.renderSlot(n.$slots,"default",{},void 0,!0)])],4)],2)}var ee=v(W,[["render",Z],["__scopeId","data-v-54e5fede"]]),Ke="";const te={name:"UpdateModal",props:{appFilePath:{type:String,default:null},id:{type:String,default:null},version:{type:String,default:null}},setup({appFilePath:n,id:o}){const a=e.ref(null),t=e.ref(!1);return{element:a,hasUpdated:t,doUpdate:()=>c(`app:update:${o}`,{element:a.value,path:n}),updateComplete:()=>t.value=!0}}},M=n=>(e.pushScopeId("data-v-0be2425c"),n=n(),e.popScopeId(),n),oe={class:"modal__title"},ne={class:"modal__ctas"},ae=M(()=>e.createElementVNode("h1",{class:"modal__title"}," App successfully updated ",-1)),se=M(()=>e.createElementVNode("p",{class:"modal__message"}," Restart the app in your own time to get the latest version. ",-1)),ie={class:"modal__ctas"};function le(n,o,a,t,s,p){return e.openBlock(),e.createElementBlock("div",{ref:"element",onClick:o[4]||(o[4]=e.withModifiers(i=>n.$emit("modal:close"),["stop"])),"onApp:updated":o[5]||(o[5]=(...i)=>t.updateComplete&&t.updateComplete(...i))},[e.createElementVNode("div",{class:"modal",onClick:o[3]||(o[3]=e.withModifiers(()=>{},["stop"]))},[t.hasUpdated?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[ae,se,e.createElementVNode("div",ie,[e.createElementVNode("button",{class:"cta cta--confirm",onClick:o[2]||(o[2]=i=>n.$emit("modal:close"))}," Okay! ")])],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h1",oe," Do you want to update to v"+e.toDisplayString(a.version)+"? ",1),e.createElementVNode("div",ne,[e.createElementVNode("button",{class:"cta cta--cancel",onClick:o[0]||(o[0]=i=>n.$emit("modal:close"))}," Nope "),e.createElementVNode("button",{class:"cta cta--confirm",onClick:o[1]||(o[1]=(...i)=>t.doUpdate&&t.doUpdate(...i))}," Sure! ")])],64))])],544)}var re=v(te,[["render",le],["__scopeId","data-v-0be2425c"]]),Qe="";const ce={name:"AppWrapper",components:{AppContainer:ee,UpdateModal:re},props:{title:{type:String,default:null},id:{type:String,default:null},appFilePath:{type:String,default:null},versionFilePath:{type:String,default:null},windowOptions:{type:Object,default:()=>({})}},setup({appFilePath:n,id:o,versionFilePath:a}){const t=e.ref(!1),s=e.ref(null);return e.onMounted(async()=>{n&&a&&(s.value=await L(winnerdow[`${o}-version`]||"0.0.0",a))}),{availableUpdate:s,showUpdateModal:t,destroy:()=>rockument.getElementById(o).remove()}}},de={class:"app-wrapper"};function pe(n,o,a,t,s,p){const i=e.resolveComponent("app-container"),l=e.resolveComponent("update-modal");return e.openBlock(),e.createElementBlock("div",de,[e.createVNode(i,e.mergeProps({title:a.title,availableUpdate:t.availableUpdate,options:a.windowOptions},{class:"app-container","onApp:click:update":o[0]||(o[0]=d=>t.showUpdateModal=!0),"onApp:close":t.destroy}),{default:e.withCtx(()=>[e.renderSlot(n.$slots,"default",{},void 0,!0)]),_:3},16,["onApp:close"]),t.showUpdateModal?(e.openBlock(),e.createBlock(l,e.mergeProps({key:0},{appFilePath:a.appFilePath,id:a.id},{version:t.availableUpdate,class:"update-modal","onModal:close":o[1]||(o[1]=d=>t.showUpdateModal=!1),"onApp:updated":o[2]||(o[2]=d=>t.availableUpdate=null)}),null,16,["version"])):e.createCommentVNode("",!0)])}var me=v(ce,[["render",pe],["__scopeId","data-v-ac30e006"]]);function _e(n){return new Date(n).toLocaleDateString()}var Xe="";const he={name:"ThemeList",props:{themes:{type:Array,default:()=>[]}},setup(){return{formatDate:_e}}},fe={key:0,class:"theme-list"},we=["src","onClick"],ge={class:"theme__name"},ye={class:"theme__author"},ue={key:1};function ke(n,o,a,t,s,p){return a.themes.length?(e.openBlock(),e.createElementBlock("ul",fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.themes,(i,l)=>(e.openBlock(),e.createElementBlock("li",{key:l,class:"theme"},[e.createElementVNode("img",{src:i.src,alt:"",class:"theme__preview",onClick:d=>n.$emit("theme:preview",i.json)},null,8,we),e.createElementVNode("h1",ge,e.toDisplayString(i.name),1),e.createElementVNode("h2",ye,e.toDisplayString(i.author),1)]))),128))])):(e.openBlock(),e.createElementBlock("p",ue," Sorry, we couldn't fetch any themes at the moment :( "))}var be=v(he,[["render",ke],["__scopeId","data-v-2147ed84"]]);const C="https://raw.githubusercontent.com/PhilipArmstead/bitburner-theme-browser",x="master",$="theme-browser",E="theme-browser-app",ve=`${C}/${x}/apps/${$}/dist/main.js`,Ee=`${C}/${x}/apps/${$}/dist/version.txt`,V="https://bitburner.daft.host/api/themes";var Be=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",id:E,appFilePath:ve,versionFilePath:Ee,themesEndpoint:V});async function Se(n){return await fetch(`${V}/${n}`).then(o=>o.json())}async function Ve(){return fetch(V)}async function Ne(n){const{data:o,meta:a}=await n.then(t=>t.json()).catch(()=>({data:[],meta:{}}));return{data:o.map(({name:t,json:s,images:p,author:i})=>{var l;return{name:t,json:s,src:(l=p[1])==null?void 0:l.src,author:i.name}}),meta:a}}var Ye="";const Me={components:{AppWrapper:me,ThemeList:be},setup(){const n=e.ref(!0),o=e.ref(!0),a=e.ref(!1),t=e.ref([]),s=e.ref({}),p=e.computed(()=>o.value?"Loading...":t.value.length?"Browse themes":"Uh oh..."),i=e.computed(()=>Math.max(1,l.value-s.value.items_per_page)),l=e.computed(()=>Math.min(s.value.total_items,s.value.page*s.value.items_per_page)),d=e.computed(()=>s.value.total_items),b={canDrag:!1,canMinimise:!1,canResize:!1},k=m=>{c("theme:cancel-preview",m),a.value=!1},f=m=>{c("theme:preview",m),a.value=!0},w=async()=>{o.value=!0;const m=Ve(),{data:g,meta:N}=await Ne(m);s.value=N,t.value=g,o.value=!1};return e.onMounted(async()=>{const m=Number(winnerdow[`${E}-theme-id`]);if(m)try{const{json:g}=await Se(m);return f(g),r(E)}catch(g){console.log(g)}n.value=!1,await w()}),{config:Be,isApplying:n,isLoading:o,isPreviewing:a,showingFrom:i,showingTo:l,themes:t,title:p,totalItems:d,windowOptions:b,cancelPreview:k,closeApp:()=>r(E),showPreview:f}}},A=n=>(e.pushScopeId("data-v-5d9c49d6"),n=n(),e.popScopeId(),n),Ce={class:"theme-browser"},xe={class:"title"},$e={key:0,class:"pagination-details"},Ae={key:2,class:"loader"},Pe=[A(()=>e.createElementVNode("span",{class:"sr-only"},"Cancel",-1))],Ue=[A(()=>e.createElementVNode("span",{class:"sr-only"},"Confirm",-1))];function Ie(n,o,a,t,s,p){const i=e.resolveComponent("theme-list"),l=e.resolveComponent("app-wrapper");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createVNode(l,e.normalizeProps(e.guardReactiveProps(O(z({},t.config),{title:"Bitburner Theme Browser",windowOptions:t.windowOptions}))),{default:e.withCtx(()=>[e.createElementVNode("div",Ce,[e.createElementVNode("h1",xe,e.toDisplayString(t.title),1),t.themes.length?(e.openBlock(),e.createElementBlock("p",$e," Showing "+e.toDisplayString(t.showingFrom)+" to "+e.toDisplayString(t.showingTo)+" of "+e.toDisplayString(t.totalItems),1)):e.createCommentVNode("",!0),t.isLoading?(e.openBlock(),e.createElementBlock("div",Ae)):(e.openBlock(),e.createBlock(i,{key:1,themes:t.themes,class:"themes","onTheme:preview":t.showPreview},null,8,["themes","onTheme:preview"]))])]),_:1},16),[[e.vShow,!t.isPreviewing&&!t.isApplying]]),e.createElementVNode("div",{class:e.normalizeClass(["preview__ctas",{"preview__ctas--visible":t.isPreviewing}])},[e.createElementVNode("button",{class:"preview__cta preview__cta--cancel",onClick:o[0]||(o[0]=(...d)=>t.cancelPreview&&t.cancelPreview(...d))},Pe),e.createElementVNode("button",{class:"preview__cta preview__cta--confirm",onClick:o[1]||(o[1]=(...d)=>t.closeApp&&t.closeApp(...d))},Ue)],2)],64)}var Fe=v(Me,[["render",Ie],["__scopeId","data-v-5d9c49d6"]]);e.createApp(Fe).mount(`#${E}`)})(Vue);

}